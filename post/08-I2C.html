<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>08-I2C | Chilh</title><meta name="author" content="chilh"><meta name="copyright" content="chilh"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="微处理器笔记 08-I2C">
<meta property="og:type" content="article">
<meta property="og:title" content="08-I2C">
<meta property="og:url" content="https://chilh.top/post/08-I2C.html">
<meta property="og:site_name" content="Chilh">
<meta property="og:description" content="微处理器笔记 08-I2C">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202306161931372.webp">
<meta property="article:published_time" content="2023-06-16T10:00:35.000Z">
<meta property="article:modified_time" content="2023-07-21T06:15:45.668Z">
<meta property="article:author" content="chilh">
<meta property="article:tag" content="大三下课程笔记">
<meta property="article:tag" content="BUPT">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202306161931372.webp"><link rel="shortcut icon" href="/"><link rel="canonical" href="https://chilh.top/post/08-I2C.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: chilh","link":"链接: ","source":"来源: Chilh","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '08-I2C',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-07-21 14:15:45'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script>LA.init({id:"Jz34H84gllFAWP2o",ck:"Jz34H84gllFAWP2o"})</script><script src="https://sdk.51.la/perf/js-sdk-perf.min.js" crossorigin="anonymous"></script><script> new LingQue.Monitor().init({id:"Jz365mPYN13QqIwT"});</script><script src="https://npm.elemecdn.com/echarts@4.9.0/dist/echarts.min.js"></script><script src="https://npm.elemecdn.com/echarts@4.9.0/map/js/china.js"></script><script src="https://npm.elemecdn.com/echarts@4.9.0/dist/echarts.min.js"></script><meta name="generator" content="Hexo 6.1.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>const preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> { preloader.endLoading() })

if (false) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/%E5%A4%B4%E5%83%8F.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">70</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">20</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 图库</span></a></div><div class="menus_item"><a class="site-page" href="/charts/"><i class="fa-fw fa fa-heartbeat"></i><span> 统计</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202306161931372.webp')"><nav id="nav"><span id="blog-info"><a href="/" title="Chilh"><span class="site-name">Chilh</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 图库</span></a></div><div class="menus_item"><a class="site-page" href="/charts/"><i class="fa-fw fa fa-heartbeat"></i><span> 统计</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">08-I2C</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-06-16T10:00:35.000Z" title="发表于 2023-06-16 18:00:35">2023-06-16</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-07-21T06:15:45.668Z" title="更新于 2023-07-21 14:15:45">2023-07-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%A4%A7%E5%AD%A6%E7%AC%94%E8%AE%B0/">大学笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>11分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="08-I2C"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="I2C"><a href="#I2C" class="headerlink" title="I2C"></a>I2C</h1><h2 id="a-Bus-oriented-Solution"><a href="#a-Bus-oriented-Solution" class="headerlink" title="a Bus-oriented Solution"></a>a Bus-oriented Solution</h2><p>I2C接口和协议:确保消息可以发送从一个设备到另一个选定的目标<img src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202305100844159.png" alt="image-20230510084443084"></p>
<h3 id="典型I2C配置方案"><a href="#典型I2C配置方案" class="headerlink" title="典型I2C配置方案"></a>典型I2C配置方案</h3><p>Master作为发送端</p>
<ul>
<li>初始发送</li>
<li>创建CLK</li>
<li>结束发送</li>
</ul>
<p>Slave作为接收端</p>
<ul>
<li>监听</li>
<li><strong>等待Master分配地址</strong></li>
<li>接收数据</li>
</ul>
<p><img src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202306112024977.png" alt="image-20230611202413851"></p>
<p>在I2C总线上，只有主设备才能启动和控制数据传输。从设备则被动地等待主设备的指令并响应</p>
<h3 id="Transfer-Procedure"><a href="#Transfer-Procedure" class="headerlink" title="Transfer Procedure"></a>Transfer Procedure</h3><p><img src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202305100855775.png" alt="image-20230510085537738"></p>
<ol>
<li>微控制器启动传输。</li>
<li>微控制器将LCD地址设置为0x27。</li>
<li>微控制器向LCD发送写入指令。</li>
<li>LCD确认来自微控制器的调用。 </li>
<li>微控制器向LCD发送数据（主-发射机和从-接收机）。</li>
<li>LCD确认接收到的数据。 </li>
<li>微控制器停止传输。</li>
</ol>
<h3 id="Transfer-Protocol"><a href="#Transfer-Protocol" class="headerlink" title="Transfer Protocol"></a>Transfer Protocol</h3><p>数据传输格式通常是8位字节。每个字节都由一个起始位、8个数据位、一个可选的奇偶校验位和一个或2个停止位组成。</p>
<p><img src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202305100901984.png" alt="image-20230510090135940"></p>
<p><strong>Slave address is 7 bits long.</strong></p>
<p><strong>Theoretically, at most 128 devices can be attached to the same bus</strong></p>
<ul>
<li><p>Address后面的一位叫<code>R/W</code>，用来表示是读取还是写，<code>0</code>表示写，<code>1</code>表示读</p>
</li>
<li><p>数据总长为一个字节，8个bits，每一个字节就要回一个ACK</p>
<p>在I2C总线上，主设备和从设备之间的通信是通过交替使用SDA和SCL线来实现的，并且每个字节都有一个相应的ACK或NACK信号来确认是否成功接收。</p>
</li>
</ul>
<h3 id="I2C-Wires-SDA-amp-SCL"><a href="#I2C-Wires-SDA-amp-SCL" class="headerlink" title="I2C Wires: SDA &amp; SCL"></a>I2C Wires: SDA &amp; SCL</h3><p>SDA是数据信号线，用于在主设备和从设备之间传输数据。SCL是时钟信号线，用于同步数据传输。</p>
<p><img src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202305100908681.png" alt="image-20230510090851646"></p>
<ul>
<li><p>Serial communications - ONE bit is sent at a time. </p>
</li>
<li><p>There are 3 elements in serial comm.: START, BIT, STOP</p>
</li>
<li><p>SDA: Serial data - transmits actual address/data bits.</p>
</li>
<li><p>SCL: Serial clock - synchronises the data.</p>
</li>
</ul>
<p>• Both are pulled up to supply VCC (‘1’) through resistors.</p>
<p>• Can be pulled down to Gnd (‘0’) by the devices.</p>
<p>在I2C总线上，SDA和SCL信号线都通过电阻器上拉到VCC电源电压（通常为5V或3.3V），以保持高电平状态。当设备需要将信号拉低时，它们可以通过将SDA和SCL连接到地（GND）来拉低这些信号线</p>
<p>两个线在<strong>默认情况下都是高电平</strong>【因为连接到了Vcc】【空闲时都是HIGH】</p>
<p>==SDA和SCL都是bi-directional的==</p>
<h3 id="I2C-Electrical-Details"><a href="#I2C-Electrical-Details" class="headerlink" title="I2C Electrical Details"></a>I2C Electrical Details</h3><p>Both SDA and SCL are bi-directional.</p>
<p>• Uses open collector/drain outputs 使用开路集电极/漏极输出</p>
<p>• Lines float HIGH unless an output goes LOW.</p>
<p>正常情况下，这些信号线处于高电平状态（即浮空），除非某个设备需要将其拉低以发送数据。</p>
<p><img src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202305100915584.png" alt="image-20230510091512546"></p>
<h3 id="SDA-amp-SCL-START-BIT-STOP"><a href="#SDA-amp-SCL-START-BIT-STOP" class="headerlink" title="SDA &amp; SCL: START, BIT, STOP"></a>SDA &amp; SCL: START, BIT, STOP</h3><p><img src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202305100916022.png" alt="image-20230510091609984"></p>
<p>• START and STOP must be generated by the master.</p>
<p><code>START</code> 和 <code>STOP</code> 都必须是由Master来创建</p>
<ul>
<li>START：SCL为1的情况下，检测到SDA中的<em><strong>下降沿</strong></em></li>
<li>STOP：SCL为1的情况下，检测到SDA中的<em><strong>上升沿</strong></em></li>
</ul>
<p><strong>• Data bit is valid only when SCL is ‘1’.</strong></p>
<p>SCL is also generated by the master.</p>
<p>时钟频率决定了数据传输速率</p>
<p><img src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202305100921512.png" alt="image-20230510092123471"></p>
<p>图中为发送address的例子，最后一位ack之前master必须releaseSDA，这样SDA回到默认的高电平状态（为了让接收机拉低以表示ack）</p>
<h4 id="Acknowledge-Signal-ACK"><a href="#Acknowledge-Signal-ACK" class="headerlink" title="Acknowledge Signal (ACK)"></a>Acknowledge Signal (ACK)</h4><p>• ACK takes place after every byte is sent.</p>
<p>It signals to the master/transmitter that the byte was successfully received.</p>
<p>发射器释放SDA线，因此接收器可以将SDA线拉低(‘0’)。</p>
<ul>
<li><p>If SDA remain ‘1’, it is a Not acknowledge signal (NACK). Possible scenarios:</p>
<p>No receiver on the bus</p>
<p>The receiver is unable to receive or transmit (not ready)</p>
<p>During the transfer, the receiver does not understand the data / cannot receive any more data bytes.</p>
<p>A master-receiver uses NACK to signal the end of the transfer to the slave-transmitter (then generates a STOP)如果主设备向从设备发送了一系列字节，并且从设备无法正确接收其中的某个字节，则它可以发送一个Not Acknowledge (NACK)信号来通知主设备停止传输。这可以避免在总线上出现死锁或其他错误情况。当主设备接收到NACK信号时，它会生成一个STOP条件来结束传输。</p>
</li>
</ul>
<h3 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a>优缺点</h3><p>优</p>
<p>Simple and easy to implement</p>
<p><strong>ICs can be attached or detached without affecting other circuits.</strong></p>
<p>There are fewer I/O pins &amp; fewer PCB tracks.</p>
<p>缺点：</p>
<ul>
<li>最慢的I2C设备支配着总线性能，尤其是时钟经常被拉长。【木桶效应】</li>
<li>7位从地址允许(理论上)在同一总线上最多128个设备。</li>
<li>因为I²C是一个共享总线，一个故障设备会挂起整个总线。例如，它保持拉SDA低(‘0’)，主机不能产生START/STOP。</li>
</ul>
<p><img src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202305101011419.png" alt="image-20230510101113249"></p>
<p><img src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202305101011133.png" alt="image-20230510101148086"></p>
<h4 id="Clock-Stretching"><a href="#Clock-Stretching" class="headerlink" title="Clock Stretching"></a>Clock Stretching</h4><p>Clock stretching: slave pulls down SCL to ‘0’ while it is not ready for more data.</p>
<p>从设备在接收到数据时，如果还没有准备好接收更多的数据，它可以将S<strong>CL线拉低来暂停时钟信号的传输</strong>，这样主设备就发不出来新数据。这可以让从设备有足够的时间来处理之前接收到的数据。主设备必须等待SCL线恢复到高电平后才能继续发送数据。在等待期间，主设备必须保持SDA线保持稳定状态以避免出现错误。</p>
<p>Master has to wait until SCL = ‘1’ again, and continues to send data after an additional minimum buffer time (say 4 μs).</p>
<p>主设备必须等待一段时间（称为buffer time）以确保从设备已经准备好接收更多的数据。这个buffer time通常是4微秒左右。</p>
<h4 id="Bus-Arbitration-总线仲裁"><a href="#Bus-Arbitration-总线仲裁" class="headerlink" title="Bus Arbitration 总线仲裁"></a>Bus Arbitration 总线仲裁</h4><p><img src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202305101023911.png" alt="image-20230510102335862"></p>
<p>如果一个设备正在发送数据并且检测到SDA和SCL线上的信号与它发送的信号不匹配，则该设备将停止发送数据并等待一段时间后再次尝试发送。</p>
<p><strong>总线判优：选取与总线发送数据相同的DATA</strong></p>
<h3 id="10-bit-Addressing"><a href="#10-bit-Addressing" class="headerlink" title="10-bit Addressing"></a>10-bit Addressing</h3><ul>
<li>10-bit addressing使得可用地址变多</li>
<li>用10-bit addressing的和用7-bit addressing的<strong>可以混在一起用</strong></li>
<li><em><strong>10位从地址由START条件(S)或重复START条件(Sr)后的后两个字节组成。</strong></em></li>
</ul>
<p><img src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202305101042932.png" alt="在这里插入图片描述"></p>
<p><img src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202305101043472.png" alt="image-20230510104319439"></p>
<h3 id="Combined-Format-amp-Repeated-Start"><a href="#Combined-Format-amp-Repeated-Start" class="headerlink" title="Combined Format &amp; Repeated Start"></a>Combined Format &amp; Repeated Start</h3><p>If the master wants to change the direction of transfer, then it simply addresses the slave again using a new R/W’ with another START signal. (instead of a STOP)</p>
<p><strong>This is usually called the “repeated START” (Sr)</strong></p>
<p><img src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202305101052856.png" alt="image-20230510105224821"></p>
<p>A master-transmitter addresses and sends a byte to a slave-receiver. Then it generates a repeated START and change the direction.  The slave then becomes a transmitter and sends data afterwards.</p>
<p><img src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202305101053015.png" alt="image-20230510105330975"></p>
<h3 id="Reserved-Address"><a href="#Reserved-Address" class="headerlink" title="Reserved Address"></a>Reserved Address</h3><p>在I2C总线协议中，每个设备都有一个唯一的7位地址，其中一些地址被保留用于特殊目的。</p>
<p><img src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202305101108996.png" alt="image-20230510110805955"></p>
<p>bit是R/W</p>
<p>如果知道保留地址永远不会用于其预期目的，则可以将保留地址用于从地址。</p>
<h4 id="General-Call-广播"><a href="#General-Call-广播" class="headerlink" title="General Call 广播"></a>General Call 广播</h4><p>Address “00000000” is reserved for general call: broadcasts to all devices connected to the bus.</p>
<p>从设备可以:</p>
<p>•用NACK忽略这个通用调用(什么都不做)</p>
<p>•对召唤做出回应和承认，并成为一个接收者。</p>
<p>I2C总线协议中，如果有多个设备响应主设备的请求，这种情况被称为wired-AND。在这种情况下，主设备不知道响应请求的设备数量。因此，设计系统时需要确保每个请求只有一个设备响应或使用其他方法（例如仲裁）来解决冲突并确保总线上的正确通信</p>
<p>The second byte in this general call determines the action requested by the master, including Software reset, START byte (for MCU transfer), Bus clear, Device ID</p>
<p>第二个字节用于指定主设备请求的操作类型。这些操作类型包括软件复位、START字节（用于MCU传输）、总线清除和设备ID等。</p>
<h2 id="Programming-I2C-in-Cortex-M3-x2F-M4"><a href="#Programming-I2C-in-Cortex-M3-x2F-M4" class="headerlink" title="Programming I2C in Cortex M3/M4"></a>Programming I2C in Cortex M3/M4</h2><p><img src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202305120831610.png" alt="image-20230512083119565"></p>
<h4 id="Slave-Mode"><a href="#Slave-Mode" class="headerlink" title="Slave Mode"></a>Slave Mode</h4><blockquote>
<p>On default, the I2C interface works in slave mode.</p>
</blockquote>
<p>• The peripheral input clock must be programmed in the I2C_CR2 register in order to generate correct timings. 在I2C_CR2寄存器中设置外设输入时钟</p>
<p>标准模式下，SCL时钟频率最高为100 kHz时，外设输入时钟频率必须至少为2 MHz</p>
<p>It match the slave address in <strong>OAR1</strong>. When matched it generates:</p>
<p>• an acknowledge pulse if the ACK bit is set </p>
<p>• the ADDR bit is set by hardware and an interrupt is generated if the ITEVFEN bit is set. </p>
<p>硬件会将ADDR位设置，并且如果ITEVFEN位被设置，则会生成一个中断</p>
<p><strong>Own Address Register</strong></p>
<p>自身地址寄存器。在I2C从设备模式下，当主设备向从设备发送数据时，主设备需要知道从设备的地址才能正确地将数据发送到该从设备。因此，在OAR1寄存器中设置了从设备的地址。</p>
<p>The TRA bit indicates whether the slave is in Receiver or Transmitter mode. </p>
<p>TRA是I2C接口的一个位，它是指“Transmitter/Receiver Address bit”，即传输器/接收器地址位。在I2C从设备模式下，当主设备向从设备发送数据时，该位指示从设备当前处于接收器模式还是传输器模式。如果该位被设置为1，则表示从设备当前处于传输器模式；如果该位被设置为0，则表示从设备当前处于接收器模式。</p>
<h5 id="Transmitter"><a href="#Transmitter" class="headerlink" title="Transmitter"></a>Transmitter</h5><p>硬件通过<u>内部移位寄存器</u><strong>从DR寄存器发送字节到SDA线</strong>。</p>
<p>当从设备向主设备发送数据时，它会将SCL线拉低，直到ADDR(从设备的地址匹配)被清除并且DR(从设备)被填充了要发送的数据（在下面的EV1和EV3-1期间）。这会强制主设备等待数据。当从设备接收到来自主设备的应答脉冲时，如果ITEVFEN和ITBUFEN位都被设置，则硬件会设置TxE位并产生中断。</p>
<ul>
<li>ITBUFEN和ITEVFEN是I2C总线上的中断控制寄存器位。它们用于控制I2C总线上的中断事件。</li>
</ul>
<p><img src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202305120929182.png" alt="image-20230512092903139"></p>
<p>EV3-1表示数据寄存器（DR）为空，软件将Data1写入DR。这意味着主设备已经向从设备发送了地址，并且从设备已经确认地址匹配。此时，主设备可以将数据写入DR并开始传输数据。EV3表示数据寄存器（DR）为空，但是移位寄存器正在传输数据。这意味着主设备已经开始向从设备发送数据，并且正在通过移位寄存器逐位传输字节。</p>
<h5 id="Receiver"><a href="#Receiver" class="headerlink" title="Receiver"></a>Receiver</h5><p>HW通过<u>内部移位寄存器</u><strong>从SDA线接收字节到DR寄存器</strong>。</p>
<p>After each byte the interface generates in sequence: </p>
<ul>
<li>ACK设置为1表示确认脉冲</li>
<li><code>RxNE</code>位由硬件设置，如果设置了<code>ITEVFEN</code>和<code>ITBUFEN</code>位，则会产生一个Interrupt。</li>
</ul>
<p>如果设置了RxNE，并且在<u>下一次数据接收结束之前没有读取DR寄存器中的数</u>据，则设置BTF位，将SCL拉低，使HW等待，<u>直到从I2C_DR寄存器读取BTF清除</u>。【确保Slave接收到了每一个bit】</p>
<p><img src="https://typorastroage.oss-cn-beijing.aliyuncs.com/img/image-20220621122047573.png" alt="image-20220621122047573"></p>
<p>接收完最后一个Byte之后，Master会发一个<code>STOP</code>，在HW检测到<code>STOP</code> bit后会设置<code>STOPF</code>bit。如果<code>ITEVFEN=1</code>的话，还会产生一个Interrupt</p>
<h4 id="Master-Mode"><a href="#Master-Mode" class="headerlink" title="Master Mode"></a>Master Mode</h4><p><em><strong>HW启动数据传输并产生时钟信号</strong></em>，其初始化顺序如下:</p>
<ul>
<li>在<code>I2C_CR2</code>中编写Peripheral input clock</li>
<li>Configure the <u>clock control registers</u></li>
<li>Configure the <u>rise time register</u></li>
<li>Program <u>I2C_CR1 registers to enable</u></li>
<li>Set the <u>START bit in I2C_CR1</u></li>
</ul>
<p>HW检查SCL是否有任何stretching</p>
<p><em><strong>设置START bit会导致 HW产生一个START(a Restart)，并切换到Master模式。</strong></em></p>
<ul>
<li>START bit由HW设置，当<code>ITEVFEN=1</code>时产生中断。</li>
</ul>
<p>Then it <strong>waits for a read of the SR1 (from SW)</strong> and  <strong>then a write to DR with the slave address</strong>.</p>
<ul>
<li>HW enters transmitter mode if R/W’ (LSB in DR) = 0;</li>
<li>HW enters receiver mode otherwise</li>
</ul>
<p>只要发送地址字节，硬件就会设置<code>ADDR bit</code>，如果<code>ITEVFEN=1</code>就会产生interrupt。</p>
<h5 id="Transmitter-1"><a href="#Transmitter-1" class="headerlink" title="Transmitter"></a>Transmitter</h5><ul>
<li>SW清除ADDR并向DR加载数据。</li>
<li>然后HW向SDA发送bytes。</li>
<li>当slave发送ACK时，<code>TxE</code>位由硬件设置，如果<code>ITEVFEN=ITBUFEN=1</code>【两个同时为1】则产生中断。</li>
<li>SW设置STOP bit，产生STOP signal。</li>
<li><u>然后HW回到slave模式</u>。</li>
</ul>
<p><img src="https://typorastroage.oss-cn-beijing.aliyuncs.com/img/image-20220621123122664.png" alt="image-20220621123122664"></p>
<h5 id="Master-i2c-write"><a href="#Master-i2c-write" class="headerlink" title="Master: i2c_write()"></a>Master: i2c_write()</h5><p>利用CMSIS的一些函数，用C代码研究基本轮询版本的主发射机。这里假设使用了I2C1【有很多I2C可以用，这里只用了一个】。</p>
<p><img src="https://typorastroage.oss-cn-beijing.aliyuncs.com/img/image-20220621123317863.png" alt="image-20220621123317863"></p>
<h5 id="Receiver-1"><a href="#Receiver-1" class="headerlink" title="Receiver"></a>Receiver</h5><ul>
<li>HW通过内部移位寄存器从SDA线路接收字节到DR。</li>
<li>After each byte the interface generates in sequence: <ul>
<li>An acknowledge pulse if the ACK bit is set</li>
<li>The RxNE bit is set and an interrupt is generated if <code>ITEVFEN=ITBUFEN=1</code>.</li>
</ul>
</li>
<li>等待从SW读取数据:如果RxNE=1，并且DR寄存器中的数据没有被读取，则设置BTF位将SCL拉低，并等待直到DR寄存器中的BTF被读取清除。</li>
</ul>
<p><img src="https://typorastroage.oss-cn-beijing.aliyuncs.com/img/image-20220621123539272.png" alt="image-20220621123539272"></p>
<h5 id="Master-i2c-read"><a href="#Master-i2c-read" class="headerlink" title="Master: i2c_read()"></a>Master: i2c_read()</h5><p><img src="https://typorastroage.oss-cn-beijing.aliyuncs.com/img/image-20220621123606082.png" alt="image-20220621123606082"></p>
<h3 id="Error-Conditions"><a href="#Error-Conditions" class="headerlink" title="Error Conditions"></a>Error Conditions</h3><p><em>A quick summary on possible errors raised by I2C interface HW.</em></p>
<p><img src="https://typorastroage.oss-cn-beijing.aliyuncs.com/img/image-20220621123649588.png" alt="image-20220621123649588"></p>
<p>在所有情况下，<em><strong>都会设置相应的错误位，并产生一个interrupt</strong></em>(==前提：如果中断错误使能==<code>ITERREN=1</code>)。</p>
<h3 id="C-Interrupts"><a href="#C-Interrupts" class="headerlink" title="C Interrupts"></a>C Interrupts</h3><p><img src="https://typorastroage.oss-cn-beijing.aliyuncs.com/img/image-20220621123750860.png" alt="image-20220621123750860"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://chilh.top">chilh</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://chilh.top/post/08-I2C.html">https://chilh.top/post/08-I2C.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://chilh.top" target="_blank">Chilh</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%A4%A7%E4%B8%89%E4%B8%8B%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/">大三下课程笔记</a><a class="post-meta__tags" href="/tags/BUPT/">BUPT</a></div><div class="post_share"><div class="social-share" data-image="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202306161931372.webp" data-sites="twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/post/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%AF%BC%E8%AE%BA%20%E7%AC%AC%E4%B8%80%E7%AB%A0%20%E8%A1%A8%E7%A4%BA.html" title="人工智能导论 第一章 表示"><img class="cover" src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202306161954208.jfif" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">人工智能导论 第一章 表示</div></div></a></div><div class="next-post pull-right"><a href="/post/07-timer.html" title="07-timer"><img class="cover" src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202306161931372.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">07-timer</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/post/01-introduction.html" title="01- introduction"><img class="cover" src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202306161931372.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-16</div><div class="title">01- introduction</div></div></a></div><div><a href="/post/01%20Introduction.html" title="互联网应用笔记（一）"><img class="cover" src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202306221734670.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-20</div><div class="title">互联网应用笔记（一）</div></div></a></div><div><a href="/post/02%20stocker%20programming.html" title="互联网应用笔记（二）"><img class="cover" src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202306221734670.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-20</div><div class="title">互联网应用笔记（二）</div></div></a></div><div><a href="/post/02-ARM%20Cortex-M4.html" title="02-ARM Cortex-M4"><img class="cover" src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202306161931372.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-16</div><div class="title">02-ARM Cortex-M4</div></div></a></div><div><a href="/post/02.5%20linux.html" title="互联网应用笔记（三）"><img class="cover" src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202306221734670.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-20</div><div class="title">互联网应用笔记（三）</div></div></a></div><div><a href="/post/04%20DHCP.html" title="互联网应用笔记（四）"><img class="cover" src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202306221734670.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-20</div><div class="title">互联网应用笔记（四）</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/%E5%A4%B4%E5%83%8F.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">chilh</div><div class="author-info__description">记录学习笔记，学艺不精，大家多多评论指教</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">70</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">20</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:1547405085@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#I2C"><span class="toc-number">1.</span> <span class="toc-text">I2C</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#a-Bus-oriented-Solution"><span class="toc-number">1.1.</span> <span class="toc-text">a Bus-oriented Solution</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B8%E5%9E%8BI2C%E9%85%8D%E7%BD%AE%E6%96%B9%E6%A1%88"><span class="toc-number">1.1.1.</span> <span class="toc-text">典型I2C配置方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Transfer-Procedure"><span class="toc-number">1.1.2.</span> <span class="toc-text">Transfer Procedure</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Transfer-Protocol"><span class="toc-number">1.1.3.</span> <span class="toc-text">Transfer Protocol</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#I2C-Wires-SDA-amp-SCL"><span class="toc-number">1.1.4.</span> <span class="toc-text">I2C Wires: SDA &amp; SCL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#I2C-Electrical-Details"><span class="toc-number">1.1.5.</span> <span class="toc-text">I2C Electrical Details</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SDA-amp-SCL-START-BIT-STOP"><span class="toc-number">1.1.6.</span> <span class="toc-text">SDA &amp; SCL: START, BIT, STOP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Acknowledge-Signal-ACK"><span class="toc-number">1.1.6.1.</span> <span class="toc-text">Acknowledge Signal (ACK)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">1.1.7.</span> <span class="toc-text">优缺点</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Clock-Stretching"><span class="toc-number">1.1.7.1.</span> <span class="toc-text">Clock Stretching</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Bus-Arbitration-%E6%80%BB%E7%BA%BF%E4%BB%B2%E8%A3%81"><span class="toc-number">1.1.7.2.</span> <span class="toc-text">Bus Arbitration 总线仲裁</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-bit-Addressing"><span class="toc-number">1.1.8.</span> <span class="toc-text">10-bit Addressing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Combined-Format-amp-Repeated-Start"><span class="toc-number">1.1.9.</span> <span class="toc-text">Combined Format &amp; Repeated Start</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Reserved-Address"><span class="toc-number">1.1.10.</span> <span class="toc-text">Reserved Address</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#General-Call-%E5%B9%BF%E6%92%AD"><span class="toc-number">1.1.10.1.</span> <span class="toc-text">General Call 广播</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Programming-I2C-in-Cortex-M3-x2F-M4"><span class="toc-number">1.2.</span> <span class="toc-text">Programming I2C in Cortex M3&#x2F;M4</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Slave-Mode"><span class="toc-number">1.2.0.1.</span> <span class="toc-text">Slave Mode</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Transmitter"><span class="toc-number">1.2.0.1.1.</span> <span class="toc-text">Transmitter</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Receiver"><span class="toc-number">1.2.0.1.2.</span> <span class="toc-text">Receiver</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Master-Mode"><span class="toc-number">1.2.0.2.</span> <span class="toc-text">Master Mode</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Transmitter-1"><span class="toc-number">1.2.0.2.1.</span> <span class="toc-text">Transmitter</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Master-i2c-write"><span class="toc-number">1.2.0.2.2.</span> <span class="toc-text">Master: i2c_write()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Receiver-1"><span class="toc-number">1.2.0.2.3.</span> <span class="toc-text">Receiver</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Master-i2c-read"><span class="toc-number">1.2.0.2.4.</span> <span class="toc-text">Master: i2c_read()</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Error-Conditions"><span class="toc-number">1.2.1.</span> <span class="toc-text">Error Conditions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#C-Interrupts"><span class="toc-number">1.2.2.</span> <span class="toc-text">C Interrupts</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/post/%E7%BC%93%E5%AD%98%E6%9B%BF%E6%8D%A2%E7%AE%97%E6%B3%951-%E7%B2%97%E9%A2%97%E7%B2%92%E7%AD%96%E7%95%A5.html" title="缓存替换算法"><img src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202505112103982.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="缓存替换算法"/></a><div class="content"><a class="title" href="/post/%E7%BC%93%E5%AD%98%E6%9B%BF%E6%8D%A2%E7%AE%97%E6%B3%951-%E7%B2%97%E9%A2%97%E7%B2%92%E7%AD%96%E7%95%A5.html" title="缓存替换算法">缓存替换算法</a><time datetime="2025-01-21T06:33:23.000Z" title="发表于 2025-01-21 14:33:23">2025-01-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/%E7%BC%93%E5%AD%98%E6%9B%BF%E6%8D%A2%E7%AE%97%E6%B3%950.html" title="Cache Replacement Policies - introduction"><img src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202306221734670.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Cache Replacement Policies - introduction"/></a><div class="content"><a class="title" href="/post/%E7%BC%93%E5%AD%98%E6%9B%BF%E6%8D%A2%E7%AE%97%E6%B3%950.html" title="Cache Replacement Policies - introduction">Cache Replacement Policies - introduction</a><time datetime="2025-01-20T11:24:52.000Z" title="发表于 2025-01-20 19:24:52">2025-01-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/%E7%BC%93%E5%AD%98%E6%9B%BF%E6%8D%A2%E7%AE%97%E6%B3%952-%E7%BB%86%E9%A2%97%E7%B2%92%E7%AD%96%E7%95%A5.html" title="缓存替换算法"><img src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202505112103982.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="缓存替换算法"/></a><div class="content"><a class="title" href="/post/%E7%BC%93%E5%AD%98%E6%9B%BF%E6%8D%A2%E7%AE%97%E6%B3%952-%E7%BB%86%E9%A2%97%E7%B2%92%E7%AD%96%E7%95%A5.html" title="缓存替换算法">缓存替换算法</a><time datetime="2025-01-20T11:24:52.000Z" title="发表于 2025-01-20 19:24:52">2025-01-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/2024-lastday.html" title="2024-总结"><img src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202501010045372.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2024-总结"/></a><div class="content"><a class="title" href="/post/2024-lastday.html" title="2024-总结">2024-总结</a><time datetime="2024-12-31T14:59:00.000Z" title="发表于 2024-12-31 22:59:00">2024-12-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/riscv%20v%E6%89%A9%E5%B1%95%E7%BF%BB%E8%AF%91%E6%80%BB%E7%BB%93.html" title="v扩展翻译总结”"><img src="https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202411102035591.jfif" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="v扩展翻译总结”"/></a><div class="content"><a class="title" href="/post/riscv%20v%E6%89%A9%E5%B1%95%E7%BF%BB%E8%AF%91%E6%80%BB%E7%BB%93.html" title="v扩展翻译总结”">v扩展翻译总结”</a><time datetime="2024-11-10T12:30:33.000Z" title="发表于 2024-11-10 20:30:33">2024-11-10</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://chilh-1311344212.cos.ap-beijing.myqcloud.com/picture/202306161931372.webp')"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2025 By chilh</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadWaline () {
  function insertCSS () {
    const link = document.createElement("link")
    link.rel = "stylesheet"
    link.href = "https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.css"
    document.head.appendChild(link)
  }

  function initWaline () {
    const waline = Waline.init(Object.assign({
      el: '#waline-wrap',
      serverURL: 'https://chilh-comment-nwkfkyqk8-zhanzghouhe.vercel.app',
      pageview: false,
      dark: 'html[data-theme="dark"]',
      path: window.location.pathname,
      comment: false,
    }, null))
  }

  if (typeof Waline === 'function') initWaline()
  else {
    insertCSS()
    getScript('https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.js').then(initWaline)
  }
}

if ('Waline' === 'Waline' || !true) {
  if (true) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
  else setTimeout(loadWaline, 0)
} else {
  function loadOtherComment () {
    loadWaline()
  }
}</script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":85,"height":400,"hOffset":-18,"vOffset":25},"mobile":{"show":true},"react":{"opacity":0.7},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>